<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plugin Movecost QGIS - Guía Completa</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; line-height: 1.6; }
        h1 { color: #2c5aa0; border-bottom: 3px solid #2c5aa0; padding-bottom: 10px; }
        h2 { color: #3d7eaa; margin-top: 40px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        h3 { color: #555; margin-top: 25px; }
        .function-card { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #2c5aa0; }
        .tutorial { background: #e8f4e8; padding: 20px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #28a745; }
        .warning { background: #fff3cd; padding: 15px; border-radius: 5px; margin: 15px 0; border-left: 4px solid #ffc107; }
        .tip { background: #d1ecf1; padding: 15px; border-radius: 5px; margin: 15px 0; border-left: 4px solid #17a2b8; }
        .param { margin-left: 20px; }
        .param-name { font-weight: bold; color: #2c5aa0; }
        code { background: #e8e8e8; padding: 2px 6px; border-radius: 3px; }
        table { border-collapse: collapse; width: 100%; margin: 15px 0; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #2c5aa0; color: white; }
        tr:nth-child(even) { background: #f9f9f9; }
        .step { background: #fff; border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .step-number { background: #2c5aa0; color: white; padding: 5px 12px; border-radius: 50%; font-weight: bold; margin-right: 10px; }
        ul.checklist { list-style: none; padding-left: 0; }
        ul.checklist li:before { content: "✓ "; color: #28a745; font-weight: bold; }
        .toc { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>Plugin Movecost QGIS - Guía Completa</h1>
    <p>Versión 2.1 - Herramienta basada en R para el cálculo de superficies de costo acumulado dependiente de la pendiente, rutas de menor costo y corredores relacionados con el movimiento humano.</p>

    <div class="toc">
        <h3>Índice</h3>
        <ul>
            <li><a href="#requirements">Requisitos y Configuración</a></li>
            <li><a href="#movecost">movecost - Superficie de Costo</a></li>
            <li><a href="#movebound">movebound - Límites de Costo</a></li>
            <li><a href="#movecorr">movecorr - Corredores</a></li>
            <li><a href="#movealloc">movealloc - Asignación</a></li>
            <li><a href="#movenetw">movenetw - Redes</a></li>
            <li><a href="#moverank">moverank - Clasificación</a></li>
            <li><a href="#functions">Funciones de Costo</a></li>
        </ul>
    </div>

    <h2 id="requirements">Requisitos y Configuración</h2>

    <div class="warning">
        <strong>Importante:</strong> Antes de usar este plugin, asegúrese de haber instalado y configurado el Processing R Provider.
    </div>

    <h3>Requisitos del Sistema</h3>
    <ul class="checklist">
        <li>QGIS 3.0 o superior (compatible con QGIS 4 y Qt6)</li>
        <li>Plugin Processing R Provider</li>
        <li>R (versión 4.0 o superior recomendada)</li>
        <li>Paquetes R: <code>movecost</code> (>= 2.1), <code>sf</code>, <code>terra</code>, <code>raster</code></li>
    </ul>

    <h3>Configuración Inicial</h3>
    <div class="step"><span class="step-number">1</span> Instale R desde <a href="https://cran.r-project.org/">cran.r-project.org</a></div>
    <div class="step"><span class="step-number">2</span> En QGIS: <strong>Complementos > Administrar complementos</strong> - instale "Processing R Provider"</div>
    <div class="step"><span class="step-number">3</span> <strong>Sketches > Sketches > Sketches de procesamiento > R</strong> - configure la ruta de R</div>
    <div class="step"><span class="step-number">4</span> En movecost, haga clic en <strong>"Agregar Scripts R"</strong></div>
    <div class="step"><span class="step-number">5</span> El plugin actualizará automáticamente el paquete movecost si es necesario</div>

    <h2 id="movecost">movecost - Superficie de Costo Acumulado</h2>

    <div class="function-card">
        <h3>Descripción</h3>
        <p>Calcula la superficie de costo acumulado anisotrópica desde un punto de origen, considerando la pendiente. También calcula las rutas de menor costo e isolíneas (isócronas).</p>
        <h4>Casos de Uso</h4>
        <ul>
            <li>Rutas óptimas entre sitios arqueológicos</li>
            <li>Tiempo de recorrido o gasto energético</li>
            <li>Mapas isócronos (áreas accesibles en un tiempo dado)</li>
            <li>Modelado de patrones de movimiento históricos</li>
        </ul>
    </div>

    <div class="tutorial">
        <h3>Tutorial: Calcular el Tiempo de Caminata entre Dos Sitios</h3>
        <div class="step"><span class="step-number">1</span> <strong>Prepare sus datos:</strong> MDT ráster, capa de puntos origen, capa de puntos destino</div>
        <div class="step"><span class="step-number">2</span> <strong>Haga clic en "movecost"</strong></div>
        <div class="step"><span class="step-number">3</span> <strong>Configure:</strong> SRC, MDT, Origen, Destino, Función='t', Tiempo='h'</div>
        <div class="step"><span class="step-number">4</span> <strong>Ejecute</strong> - obtendrá: Superficie de costo, Isolíneas, Rutas LCP</div>
    </div>

    <h2 id="movebound">movebound - Límites de Costo de Caminata</h2>

    <div class="function-card">
        <h3>Descripción</h3>
        <p>Crea polígonos de límite de costo de caminata alrededor de puntos (ej: "área accesible en 1 hora").</p>
        <h4>Casos de Uso</h4>
        <ul>
            <li>Áreas de captación alrededor de asentamientos</li>
            <li>Radios de recolección</li>
            <li>Límites territoriales basados en el tiempo de caminata</li>
        </ul>
    </div>

    <h2 id="movecorr">movecorr - Corredores de Menor Costo</h2>

    <div class="function-card">
        <h3>Descripción</h3>
        <p>Calcula el corredor de menor costo entre dos puntos - no solo la ruta óptima, sino una zona de rutas similarmente de bajo costo.</p>
    </div>

    <div class="tip">
        <strong>Consejo:</strong> Un corredor estrecho indica restricciones del terreno. Corredores anchos sugieren múltiples rutas alternativas.
    </div>

    <h2 id="movealloc">movealloc - Asignación de Costos</h2>

    <div class="function-card">
        <h3>Descripción</h3>
        <p>Dados múltiples orígenes, cada celda se asigna al origen más cercano según el costo de caminata (polígonos de Voronoi basados en costo).</p>
    </div>

    <h2 id="movenetw">movenetw - Redes de Rutas</h2>

    <div class="function-card">
        <h3>Descripción</h3>
        <p>Crea una red de rutas de menor costo entre múltiples ubicaciones. Modo "all-pairs" (todos conectados a todos) o "nearest neighbor" (solo vecinos más cercanos).</p>
    </div>

    <h2 id="moverank">moverank - Clasificación de Destinos</h2>

    <div class="function-card">
        <h3>Descripción</h3>
        <p>Calcula la ruta de menor costo Y rutas alternativas subóptimas (2ª, 3ª, 4ª mejor ruta).</p>
    </div>

    <h2 id="functions">Funciones de Costo</h2>

    <h3>Tiempo de Caminata</h3>
    <table>
        <tr><th>Código</th><th>Nombre</th><th>Descripción</th></tr>
        <tr><td><code>t</code></td><td>Tobler (en sendero)</td><td>Función clásica de Tobler. La más utilizada.</td></tr>
        <tr><td><code>tofp</code></td><td>Tobler (fuera de sendero)</td><td>Para caminata sin senderos.</td></tr>
        <tr><td><code>wcs</code></td><td>Pendiente crítica vehículos</td><td>Para carros/vehículos con ruedas.</td></tr>
        <tr><td><code>p/pcf</code></td><td>Pandolf</td><td>Costo metabólico con peso corporal y carga.</td></tr>
    </table>

    <h2>Solución de Problemas</h2>
    <div class="warning">
        <ul>
            <li><strong>Error dgCMatrix:</strong> El plugin actualiza automáticamente movecost R >= 2.1</li>
            <li><strong>R no encontrado:</strong> Verifique Sketches > Opciones > R</li>
            <li><strong>Scripts no visibles:</strong> Haga clic en "Agregar Scripts R"</li>
        </ul>
    </div>

    <h2>Créditos</h2>
    <p><strong>Plugin QGIS:</strong> Enzo Cocca (adArte srl)</p>
    <p><strong>Paquete R:</strong> Gianmarco Alberti</p>
    <p><strong>Repositorio:</strong> <a href="https://github.com/enzococca/movecost">github.com/enzococca/movecost</a></p>
</body>
</html>
